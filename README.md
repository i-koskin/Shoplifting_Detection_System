# üëÅÔ∏è‚Äçüó®Ô∏è  Shoplifting_Detection_System

## –°–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![YOLO](https://img.shields.io/badge/YOLO-11-pink.svg)](https://ultralytics.com/)
[![XGBoost](https://img.shields.io/badge/XGBoost-Latest-orange.svg)](https://xgboost.ai/)

<p align="center">
<img src="assets/out_cam.gif")>
</p>

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **üéØ –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - YOLO11-pose –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–∑—ã —á–µ–ª–æ–≤–µ–∫–∞
- **ü§ñ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è** - XGBoost –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **üîÑ –¢—Ä–µ–∫–∏–Ω–≥ –æ–±—ä–µ–∫—Ç–æ–≤** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª—é–¥–µ–π –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏
- **‚ö° –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π** 
- **üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∞–ª–µ—Ä—Ç–æ–≤
- **üìπ  –í—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤–∏–¥–µ–æ—Å–∏–≥–Ω–∞–ª–∞** - —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –≤–∏–¥–µ–æ (–≤–µ–±-–∫–∞–º–µ—Ä–∞, IP-–∫–∞–º–µ—Ä–∞, –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã)
- **üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
- **‚ö°–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º:**

*- –ü–æ—Ä–æ–≥ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ—Ç–µ–∫—Ü–∏–π*

*- –ü–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞*

*- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è*

- **üîß –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã
  
***üõ† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞:***
  
*- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤ –≤–º–µ—Å—Ç–æ RTSP –ø–æ—Ç–æ–∫–æ–≤*

*- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã*

*- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–µ–æ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏*

*- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤*

*- –£–ø—Ä–æ—â—ë–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏*

## üì∏ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

<p align="center">
<img src="./assets/out_cam2_1.jpg" width="900">
<img src="./assets/out_cam2_2.jpg" width="900">
<img src="./assets/out_cam2_3.jpg" width="900">
</p>

**üé® –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è**:
- üü¢ –ó–µ–ª–µ–Ω—ã–π - –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
- üî¥ –ö—Ä–∞—Å–Ω—ã–π - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ




## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
```mermaid
graph TD
    A[–í–∏–¥–µ–æ–ø–æ—Ç–æ–∫] --> B[YOLO Pose Detection]
    B --> C[–¢—Ä–µ–∫–∏–Ω–≥ –æ–±—ä–µ–∫—Ç–æ–≤]
    C --> D[–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫]
    D --> E[XGBoost Classification]
    E --> F{–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏}
    F -->|–í–∞–ª–∏–¥–Ω–æ| G[–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞]
    F -->|–ù–µ –≤–∞–ª–∏–¥–Ω–æ| H[–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞]
    G --> I[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤]
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/i-koskin/Shoplifting_Detection_System.git
cd Shoplifting_Detection_System

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
py -m venv venv
source venv/bin/activate  # Linux/MacOS
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
.

‚îú‚îÄ‚îÄ **shoplifting_detector.py**   *# –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–µ—Ç–µ–∫—Ü–∏–∏*

‚îú‚îÄ‚îÄ **tksoft_norm.py**            *# –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º*

‚îú‚îÄ‚îÄ **tksoft_susp.py**            *# –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º*

‚îú‚îÄ‚îÄ **img_prepare.py**            *# –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤*

‚îú‚îÄ‚îÄ **dataset.py**                *# –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏*

‚îú‚îÄ‚îÄ **model.py**                  *# –ú–æ–¥—É–ª—å –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–¥–±–æ—Ä–æ–º –æ–ø–∏–º–∞–ª—å–Ω—ã—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤*

‚îú‚îÄ‚îÄ **requirements.txt**          *# –§–∞–π–ª —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏*

‚îú‚îÄ‚îÄ **.env.production**           *# –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ production* 

‚îú‚îÄ‚îÄ **.env.test**                 *# –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ test*  

‚îú‚îÄ‚îÄ **yolo11s-pose.pt**           *# –ú–æ–¥–µ–ª—å YOLO –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∑—ã*

‚îú‚îÄ‚îÄ **trained_model_1.json**      *# –ú–æ–¥–µ–ª—å XGBoost –¥–ª—è –∫–∞–º–µ—Ä—ã cam1*

‚îú‚îÄ‚îÄ **logs/**                     *# –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã*

‚îÇ   ‚îî‚îÄ‚îÄ shoplifting_cam1.log

‚îú‚îÄ‚îÄ **alerts/**                   *# –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ –∞–ª–µ—Ä—Ç—ã*

‚îÇ   ‚îî‚îÄ‚îÄ **cam1/**

‚îÇ       ‚îú‚îÄ‚îÄ **alerts_images/**    *# –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤*

‚îÇ       ‚îî‚îÄ‚îÄ **alerts_videos/**    *# –í–∏–¥–µ–æ—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤*

‚îú‚îÄ‚îÄ **debug/**                    *# –§–∞–π–ª—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏*

‚îÇ   ‚îî‚îÄ‚îÄ **cam1/**

‚îî‚îÄ‚îÄ **test_videos/**              *# –¢–µ—Å—Ç–æ–≤—ã–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã*
 
‚îÇ   ‚îî‚îÄ‚îÄ test_cam1.mp4


## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–µ–π:

```mermaid
graph TD
    A[–¢–µ—Å—Ç–æ–≤—ã–π –≤–∏–¥–µ–æ—Ñ–∞–π–ª] --> B[tksoft_norm.py]
    A --> C[tksoft_susp.py]
    B --> D[img_prepare.py]
    C --> D
    D  --> E[dataset.py]
    E --> F[model.py]
```
### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

*–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥ –≤–∞—à—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ñ–∞–π–ª—ã:*

*  .env.production;

*  .env.test

### 3. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã:

```bash
py shoplifting-detector.py
```

#### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
–í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (SHOW_DISPLAY=true):

q - –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

s - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞

p - –ø–∞—É–∑–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤–∏–¥–µ–æ
